<html>
<head>
	<title>Projna</title>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="../images/logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <script src="https://cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="scripts/utility.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/mystyle.css"/>
</head>
<body>
	<div class = "container-fluid">
		<div id = "divH"></div>
		<div id = "divC">
			<div id = 'divcover'>
				<div class = 'cover' align = 'center'>
					<span id = 'brand'>Projna</span><br>
					<span id = 'slogan1'>Trust in Building Persons</span><br>
					<span id = 'slogan2'>#Projects</span><br><br>
					<a id = 'learnmore' href=''>- Learn More -</a><br>
					<button id = 'joinnow' class = 'btn btn-default' onclick="location.href='/user/signup'">Join Now</button>
				</div>
			</div>
		</div>
		<div id = "divF"></div>
	</div>
</body>
<script type="text/javascript">
	$("#divH").load("pages/utility.html #divheader");
	$("#divF").load("pages/utility.html #divfooter");
</script>
<script type="text/javascript">
//with model of this page, we can render this page based on this model, so we can code the rendering part first,
//then we can code the communication part for the dynamic context, rewrite model, and render again by just calling the render function
//all the input function should be put in here first, it's part of control.



	//control part, check the pageData and call the right js function for next level control
function updatePage(){
	updateProjna();
}
function updateProjna(){
//ajax and update pageData;
	//find what user it is looking at
	var lookingID = ""
	lookingID = getThePerson();
	//ajax for the user's projna data
	if(lookingID != ""){
		pageData.person = lookingID;
	}

	$.ajax({
		type:"GET",url:"/user/getprojna",data:{_id : pageData.person},
		async:false,
		success: function(msg){
//update projna
			pageData.projna = msg.projna;
			pageData.personName =msg.nickname;
		},
		error: function(msg){alert("somethin xiaoyue!");}
	});

}

function renderPage(){
	renderProjna();
}

function renderProjna(){
	//get the cover
	var dc = $("#divC");
	if (pageData.login === "visitor") {
		$("#divcover").show();
	}else{$("#divcover").hide();renderProjnaName(pageData.personName);};
	//render the projna list
	var dprojna = $("<div id = 'divmyprojects' class = 'container' align = 'center'></div>");
	var dpjpl = $("<div><div id = 'pjlist' class = 'col-sm-6 col-md-3'><a href = '#' class='thumbnail'><img src='../images/Pro1-pic.jpg' alt='通用的占位符缩略图'><h3 class = 'caption'>Project Name</h3></a></div></div>");
	pageData.projna.forEach(function(pj){
		var pjpl = dpjpl.clone();
		pjpl.find("h3").text(pj.name);
		pjpl.find("img").attr("src",'../images/'+pj.pic+'.jpg');
		if(pj.state === "intro"){
			pjpl.find("a").attr("href",'/project/'+pj.id);
		}else if (pj.state === "build"){
			pjpl.find("a").attr("href",'/project/'+pj.id+'/build/'+pageData.person);
		}
		
		dprojna.append(pjpl);
	});
	dc.append(dprojna);
}
</script>
</html>
<!-- 
$('#loadButton').click(function(){
$.getScript('new.js',function(){
newFun('"Checking new script"');//这个函数是在new.js里面的，当点击click后运行这个函数
}); 

$("script[src='../static/js/cpu_memory.js']").remove(); 
$("script[src='../static/js/wan_flow.js']").remove(); 
-->